# 支持命名空间的控制器配置
# 使用通配符/**来支持任意命名空间
/**:
  controller_manager:
    ros__parameters:
      update_rate: 20  

      diff_drive_controller:
        type: diff_drive_controller/DiffDriveController

      joint_state_broadcaster:
        type: joint_state_broadcaster/JointStateBroadcaster

      # imu_sensor_broadcaster:
      #   type: imu_sensor_broadcaster/IMUSensorBroadcaster

  diff_drive_controller:
    ros__parameters:
      left_wheel_names: ["front_left_wheel_joint", "rear_left_wheel_joint"]
      right_wheel_names: ["front_right_wheel_joint", "rear_right_wheel_joint"]
      wheel_separation: 0.26  # 左右轮距离 26cm
      wheel_radius: 0.08      # 轮子半径 8cm
      publish_rate: 20.0      
      odom_frame_id: odom
      base_frame_id: base_footprint
      use_stamped_vel: false  # false: 订阅 /cmd_vel_unstamped (Twist)，配合标定脚本改为发布到/cmd_vel_unstamped
      enable_odom_tf: false    # 标定odom时需要由diff_drive_controller发布 odom→base_footprint TF，方便脚本通过TF读取位姿

      # Odometry settings
      odom_only_twist: true  # 使用完整的odom信息
      position_feedback: true
      velocity_feedback: true

      # 稳定性设置
      open_loop: false        # 使用反馈控制
      
      # Velocity and acceleration limits
      linear:
        x:
          has_velocity_limits: true
          max_velocity: 2.0
          has_acceleration_limits: true
          max_acceleration: 0.8
      angular:
        z:
          has_velocity_limits: true
          max_velocity: 2.0
          has_acceleration_limits: true
          max_acceleration: 1.6

  joint_state_broadcaster:
    ros__parameters:
      {}

  # imu_sensor_broadcaster:
  #   ros__parameters:
  #     sensor_name: "imu_sensor"
  #     frame_id: "imu_link"
  #     # 静态协方差矩阵 (可选)
  #     static_covariance_orientation: [0.01, 0.0, 0.0, 0.0, 0.01, 0.0, 0.0, 0.0, 0.01]
  #     static_covariance_angular_velocity: [0.01, 0.0, 0.0, 0.0, 0.01, 0.0, 0.0, 0.0, 0.01]
  #     static_covariance_linear_acceleration: [0.01, 0.0, 0.0, 0.0, 0.01, 0.0, 0.0, 0.0, 0.01]
